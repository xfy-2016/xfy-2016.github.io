{"tags":[{"name":"前端 js","permalink":"http://yoursite.com/tags/前端-js/","url":"/async/tags/前端 js.json","count":1}],"categories":[{"name":"前端知识","permalink":"http://yoursite.com/categories/前端知识/","url":"/async/categories/前端知识.json","count":2}],"url":"/async/posts/2016/06/06/跨域.json","date":1465218622000,"path":{"year":2016,"month":6,"day":6,"name":"跨域"},"title":"跨域","permalink":"http://yoursite.com/2016/06/06/跨域/","content":"<h2 id=\"域的概念：\"><a href=\"#域的概念：\" class=\"headerlink\" title=\"域的概念：\"></a>域的概念：</h2><p>只要协议、端口、域名有任何一个不同，都被当作是不同的域。<br>其中端口和协议的不同的跨域，只能通过后台来解决。</p>\n<h3 id=\"方法一：-CORS\"><a href=\"#方法一：-CORS\" class=\"headerlink\" title=\"方法一： CORS\"></a>方法一： CORS</h3><p>设置服务器端Access-Control-Allow-Origin</p>\n<h3 id=\"方法二：jsonp\"><a href=\"#方法二：jsonp\" class=\"headerlink\" title=\"方法二：jsonp\"></a>方法二：jsonp</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></div><div class=\"line\">     function dosomething(jsondata) &#123;</div><div class=\"line\">          //处理获得的json数据</div><div class=\"line\">     &#125;</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://example.com/data.php?callback=dosomething\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>缺点：只能实现Get请求，不能解决不同域的两个页面之间如何进行javaScript调用的问题。</p>\n<h3 id=\"方法三：修改document-domain\"><a href=\"#方法三：修改document-domain\" class=\"headerlink\" title=\"方法三：修改document.domain\"></a>方法三：修改document.domain</h3><p>只适用于不同子域的框架间的交互</p>\n<h3 id=\"方法四：window-name\"><a href=\"#方法四：window-name\" class=\"headerlink\" title=\"方法四：window.name\"></a>方法四：window.name</h3><p>通过读写window.name属性进行跨域通信</p>\n<h3 id=\"方法五：window-postMessage\"><a href=\"#方法五：window-postMessage\" class=\"headerlink\" title=\"方法五：window.postMessage\"></a>方法五：window.postMessage</h3><p>发送信息<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> iframe = <span class=\"built_in\">document</span>.getElementById(‘iframe’);</div><div class=\"line\"><span class=\"keyword\">var</span> win = iframe.contentWindow;</div><div class=\"line\">win.postMessage(<span class=\"string\">'我是信息’,’*’);</span></div></pre></td></tr></table></figure></p>\n<p>获取信息<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">window</span>.onmessage = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">e</span>) </span>&#123;</div><div class=\"line\">     e = e||event;</div><div class=\"line\">     alert(e.data);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n"}